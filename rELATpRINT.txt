#include "protheus.ch"                        

User Function STTCCRELAT()                                
	
LOCAL nFor  := 0
LOCAL nFor2 := 0
LOCAL cDado := ""
LOCAL uDado := ""
LOCAL cPerg       	:= "" 					   		// Pergunta padrao (SX1) dos parametros
PRIVATE nQtdLin     := 58       			   		// Qtd de Linhas Por Pagina
PRIVATE nLimite     := 132       			   		// Limite de Colunas
PRIVATE cTamanho    := "M"       			   		// P=Pequeno;M=Medio;G=Grande -> P=80;M=132;G=220 (colunas)                               
PRIVATE cRel        := "IMPCRIGEN" 					// Nome do Relatorio
PRIVATE cTitulo     := 	"RELATÓRIO TOTVS IP"			// Titulo do Relatorio
PRIVATE cDesc1      := 	"Código" 							// Descritivo para o usuario
PRIVATE cDesc2      := 	"Cod. Forn." 							// Descritivo para o usuario
PRIVATE cDesc3      := 	"Loja"
PRIVATE cDesc4      := 	"Nome Fornec."	
PRIVATE cDesc5      :=	"Certif"
PRIVATE cDesc6      :=	"Val. Certif."
PRIVATE cDesc7      :=  "Tolera"
PRIVATE cDesc8      :=  "total OK"
PRIVATE cDesc9      :=  "Total NÃO OK"
PRIVATE cAlias      := 	"ZZ1"	 						// Alias
PRIVATE cCabecalhoRelat := "RELATÓRIO DE TODOS OS REGISTROS DO CONTROLE DE FORNECIMENTO"
PRIVATE nli         := 01   						// Variavel padrao para controlar numero de linha
PRIVATE nQtdini     := nli  						// Variavel para controlar numero de linha inicial
PRIVATE m_pag       := 1    						// Variavel padrao para contar numero da pagina
PRIVATE lCompres    := .F. 							// nao mude e padrao
PRIVATE lDicion     := .F. 							// nao mude e padrao
PRIVATE lFiltro     := .F. 							// Habilitar o filtro ou nao
PRIVATE lCrystal    := .F. 							// nao mudar controle do crystal reports
PRIVATE aReturn     := { "", 1,"", 1, 1, 1, "",1 } 	// padrao nao mude
PRIVATE lAbortPrint := .F.							// Controle para abortar (sempre como esta aqui)
PRIVATE cCabec1     := "" 							// Primeira linha do cabecalho ;
PRIVATE cCabec2     := "" 							// utilizado pela funcao cabec...
PRIVATE nColuna     := 03 							// Numero da coluna que sera impresso as colunas


cRel	:= SetPrint(cAlias,cRel,"",@cTitulo,cDesc1,cDesc2,cDesc3, .F., {}, .F., cTamanho, , .F.)   

SetDefault(aReturn,cAlias)

@ ++nLi, 52 pSay "RELATÓRIO TOTVS IP"

@ ++nLi, nColuna pSay Replicate("-",nLimite-nColuna)
@ ++nLi, 40 pSay cCabecalhoRelat
@ ++nLi, nColuna pSay Replicate("-",nLimite-nColuna)
@ ++nLi, 03 pSay cDesc1
@ nLi, 12 pSay cDesc2
@ nLi, 24 pSay cDesc3
@ nLi, 33 pSay cDesc4
@ nLi, 52 pSay cDesc5
@ nLi, 73 pSay cDesc6
@ nLi, 87 pSay cDesc7
@ nLi, 101 pSay cDesc8
@ nLi, 115 pSay cDesc9
@ ++nLi, nColuna pSay Replicate("-",nLimite-nColuna)

	dbSelectArea(cAlias) 	// SELECIONA A TABELA
    dbSetOrder(1) 			// DEFINE O INDICE A SER UTILIZADO
    ZZ1->(dbGoTop()) 		// VAI PAR AO PRIMEIRO REGISTRO
    

    While !ZZ1->(Eof()) .And. !lAbortPrint

        @ ++nLi, 03 PSAY SubStr(ZZ1->ZZ1_CODIGO,1,3)
        @ nLi, 15 PSAY ZZ1->ZZ1_FORNEC
        @ nLi, 24 PSAY ZZ1->ZZ1_LOJAFO        				
        @ nLi, 33 PSAY SubStr(Posicione("SA2",1,xFilial("SA2")+ZZ1->ZZ1_FORNEC+ZZ1->ZZ1_LOJAFO,"A2_NOME"), 1, 15)
        @ nLi, 52 PSAY Substr(ZZ1->ZZ1_CERTIF,1,20) 
        @ nLi, 74 PSAY DTOS(ZZ1->ZZ1_VALCER) PICTURE "@E 99/99/99"
        @ nLi, 90 PSAY ZZ1->ZZ1_TOLERA
        @ nLi, 104 PSAY ZZ1->ZZ1_TOTOK
        @ nLi, 119 PSAY ZZ1->ZZ1_TOTNOK
//        @ nLi, 115 PSAY ZZ1->ZZ1_LOJAFO


        ZZ1->(dbSkip())
		nFor++
    EndDo
    
@ ++nLi, nColuna pSay Replicate("-",nLimite-nColuna)
@ ++nLi, 52 pSay StrZero(nFor,2)+" Registro(s) Listado(s)"
@ ++nLi, nColuna pSay Replicate("-",nLimite-nColuna)


Set Printer To
Ourspool(cRel)

Return 

